angular.module("JarvisApp","ngMaterial ngMdIcons ngSanitize restangular angular-websocket ui.router ui.router.router pascalprecht.translate ngCookies hljs ui.tree JarvisApp.websocket JarvisApp.config JarvisApp.theme JarvisApp.routes JarvisApp.services JarvisApp.services.filter JarvisApp.services.generic JarvisApp.services.scope JarvisApp.services.plugin JarvisApp.services.command JarvisApp.services.scenario JarvisApp.services.snapshot JarvisApp.services.cron JarvisApp.services.view JarvisApp.services.configuration JarvisApp.services.property JarvisApp.services.connector JarvisApp.services.iot JarvisApp.services.event JarvisApp.services.trigger JarvisApp.services.block JarvisApp.directives JarvisApp.directives.widgets JarvisApp.ctrl.plugins JarvisApp.ctrl.commands JarvisApp.ctrl.iots JarvisApp.ctrl.events JarvisApp.ctrl.triggers JarvisApp.ctrl.snapshots JarvisApp.ctrl.crons JarvisApp.ctrl.views JarvisApp.ctrl.configurations JarvisApp.ctrl.properties JarvisApp.ctrl.connectors JarvisApp.ctrl.scenarios JarvisApp.ctrl.blocks JarvisApp.ctrl.home".split(" "));
"use strict";var jarvisServicesUrl="/services",jarvisApiUrl="/api",myAppServices=angular.module("JarvisApp.services",["ngResource"]);
myAppServices.factory("toastService",["$log","$mdToast",function(a,b){a=angular.injector(["ng"]).get("$log");a.info("toastService",b);var c;return c={toastPosition:{bottom:!0,top:!1,left:!1,right:!0},getToastPosition:function(){return Object.keys(c.toastPosition).filter(function(a){return c.toastPosition[a]}).join(" ")},failure:function(d){a.error(d);b.show(b.simple().content(d).position(c.getToastPosition()).hideDelay(3E3).theme("failure-toast"))},info:function(d){a.info(d,c.getToastPosition());
b.show(b.simple().position(c.getToastPosition()).textContent(d).hideDelay(3E3).capsule(!0))}}}]);myAppServices.factory("clientResourceService",["$q","$window","$rootScope","Restangular",function(a,b,c,d){angular.injector(["ng"]).get("$log").info("clientResourceService",a);return{findAll:function(a,c){d.all("clients").getList().then(function(f){a(f)},function(a){c(a)})}}}]);
myAppServices.factory("crontabResourceService",["$q","$window","$rootScope","Restangular",function(a,b,c,d){angular.injector(["ng"]).get("$log").info("crontabResourceService",a);return{findAll:function(a,c){d.all("crontabs").getList().then(function(f){a(f)},function(a){c(a)})}}}]);
myAppServices.factory("labelResourceService",["$q","$window","$rootScope","Restangular",function(a,b,c,d){angular.injector(["ng"]).get("$log").info("labelResourceService",a);return{findAll:function(a,c){d.all("labels").getList().then(function(f){a(f)},function(a){c(a)})}}}]);"use strict";myAppServices=angular.module("JarvisApp.services.filter",[]);
myAppServices.factory("filterService",["Restangular",function(a){return{plain:function(b){if(angular.isArray(b)||angular.isObject(b))b=a.stripRestangular(b),delete b.originalElement;return b}}}]);"use strict";
angular.module("JarvisApp.services.generic",["JarvisApp.services.filter"]).factory("genericResourceService",["$log","Restangular","filterService","toastService",function(a,b,c,d){a.info("genericResourceService");var e={findAll:function(f,d,e){var g=function(b){var e=[];_.forEach(b,function(a){e.push(c.plain(a))});a.debug("[FIND]",f,e);d(e)};1==f.length?b.all(f[0]).getList().then(g,function(a){e(a)}):b.all(f[0]).all(f[1]).getList().then(g,function(a){e(a)})},get:function(f,d,e,g){var k=function(b){b=
c.plain(b);a.debug("[GET]",f,b);void 0!=e&&e(b)};1==f.length?b.one(f[0],d).get().then(k,function(a){g(a)}):b.all(f[0]).one(f[1],d).get().then(k,function(a){g(a)})},delete:function(f,d,e,g){var k=function(b){b=c.plain(b);a.debug("[DELETE]",f,b);void 0!=e&&e(b)};1==f.length?b.one(f[0],d).remove().then(k,function(a){g(a)}):b.all(f[0]).one(f[1],d).remove().then(k,function(a){g(a)})},put:function(f,d,e,g){var k=function(b){b=c.plain(b);a.debug("[PUT]",f,b);void 0!=e&&e(b)};1==f.length?b.one(f[0],d.id).customPUT(d).then(k,
function(a){g(a)}):b.all(f[0]).one(f[1],d.id).customPUT(d).then(k,function(a){g(a)})},post:function(f,d,e,g){var k=function(b){b=c.plain(b);a.debug("[POST]",f,b);void 0!=e&&e(b)};1==f.length?b.all(f[0]).post(d).then(k,function(a){g(a)}):b.all(f[0]).all(f[1]).post(d).then(k,function(a){g(a)})},task:function(f,d,e,g,k,l){var n=function(b){var d=c.plain(b);a.debug("[TASK]",b,f,d);void 0!=k&&k(d)};1==f.length?b.all(f[0]).one(d).customPOST(g,"",{task:e}).then(n,function(a){l(a)}):b.all(f[0]).all(f[1]).one(d).customPOST(g,
"",{task:e}).then(n,function(a){l(a)})}},g={findAll:function(f,d,e,g,k,l){var n=function(b){var l=[];_.forEach(b,function(a){l.push(c.plain(a))});a.debug("[FIND/L/"+e+"]",f,d,g,l);k(l)};1==d.length?1==f.length?b.one(f[0],g).all(d[0]).getList({href:e}).then(n,function(a){l(a)}):b.all(f[0]).one(f[1],g).all(d[0]).getList({href:e}).then(n,function(a){l(a)}):1==f.length?b.one(f[0],g).all(d[0]).all(d[1]).getList({href:e}).then(n,function(a){l(a)}):b.all(f[0]).one(f[1],g).all(d[0]).all(d[1]).getList({href:e}).then(n,
function(a){l(a)})},post:function(f,d,e,g,k,l,n,p){var r=function(b){b=c.plain(b);a.debug("[POST/L]",f,b);void 0!=n&&n(b)};void 0!=l&&(l.href=e);1==d.length?1==f.length?b.one(f[0],g).one(d[0],k).customPOST(l).then(r,function(a){p(a)}):b.all(f[0]).one(f[1],g).one(d[0],k).customPOST(l).then(r,function(a){p(a)}):1==f.length?b.one(f[0],g).all(d[0]).one(d[1],k).customPOST(l).then(r,function(a){p(a)}):b.all(f[0]).one(f[1],g).all(d[0]).one(d[1],k).customPOST(l).then(r,function(a){p(a)})},put:function(f,
d,e,g,k,l,n,p,r){var t=function(b){b=c.plain(b);a.debug("[PUT/L]",f,b);void 0!=p&&p(b)},s={},s=void 0===n?{}:n;s.href=e;1==d.length?1==f.length?b.one(f[0],g).one(d[0],k).one(l).customPUT(s).then(t,function(a){r(a)}):b.all(f[0]).one(f[1],g).one(d[0],k).one(l).customPUT(s).then(t,function(a){r(a)}):1==f.length?b.one(f[0],g).all(d[0]).one(d[1],k).one(l).customPUT(s).then(t,function(a){r(a)}):b.all(f[0]).one(f[1],g).all(d[0]).one(d[1],k).one(l).customPUT(s).then(t,function(a){r(a)})},delete:function(f,
d,e,g,k,l,n,p){var r=function(b){b=c.plain(b);a.debug("[DELETE/L]",f,b);void 0!=n&&n(b)};1==d.length?1==f.length?b.one(f[0],g).one(d[0],k).remove({instance:l,href:e}).then(r,function(a){p(a)}):b.all(f[0]).one(f[1],g).one(d[0],k).remove({instance:l,href:e}).then(r,function(a){p(a)}):1==f.length?b.one(f[0],g).all(d[0]).one(d[1],k).remove({instance:l,href:e}).then(r,function(a){p(a)}):b.all(f[0]).one(f[1],g).all(d[0]).one(d[1],k).remove({instance:l,href:e}).then(r,function(a){p(a)})}};return{crud:function(a){return{findAll:function(b,
d){return e.findAll(a,b,d)},get:function(b,d,c){return e.get(a,b,d,c)},delete:function(b,d,c){return e.delete(a,b,d,c)},put:function(b,d,c){return e.put(a,b,d,c)},post:function(b,d,c){return e.post(a,b,d,c)},task:function(b,d,c,g,l){return e.task(a,b,d,c,g,l)}}},links:function(a,b,d){void 0===d&&(d="HREF");return{findAll:function(c,e,l){return g.findAll(a,b,d,c,e,l)},delete:function(c,e,l,n,p){return g.delete(a,b,d,c,e,l,n,p)},put:function(c,e,l,n,p,r){return g.put(a,b,d,c,e,l,n,p,r)},post:function(c,
e,l,n,p){return g.post(a,b,d,c,e,l,n,p)}}},scope:{collections:{new:function(b,c,e,g,k){g.post(e,function(d){a.debug(b+" "+d.name+"#"+d.id+" created");c.push(d);k&&k(d)},d.failure)},findAll:function(b,c,e,g,k){a.debug("loading ",b,g);e.splice(0,e.length);g.findAll(c,function(d){_.forEach(d,function(a){e.push(a)});a.debug("loaded ",b,e);k&&k(e)},d.failure)}},entity:{get:function(b,c,e){e.get(b,function(b){c(b);a.debug("[GET/scope] "+b.name+"#"+b.id)},d.failure)},remove:function(a,b,c,e){e.delete(c.id,
function(e){d.info(b+" "+c.name+"#"+c.id+" removed");a()},d.failure)},save:function(a,b,c){c.put(b,function(c){d.info(a+" "+b.name+"#"+b.id+" updated")},d.failure)},duplicate:function(a,b,c,e){e.post(c,function(e){d.info(b+" "+c.name+"#"+c.id+" duplicated");a()},d.failure)}},link:{add:function(b,c,e,g,k){void 0!=c&&void 0!=c.id&&""!=c.id&&g.post(b,c.id,e,function(b){a.debug("addLink",b);k.push(b)},d.failure)},save:function(b,c,e){void 0!=c&&void 0!=c.id&&""!=c.id&&e.put(b,c.id,c.instance,c.extended,
function(b){a.debug("updateLink - before",c);a.debug("updateLink - after",b)},d.failure)},remove:function(b,c,e,g){void 0!=c&&void 0!=c.id&&""!=c.id&&e.delete(b,c.id,c.instance,function(b){var d=c.instance;_.remove(g,function(a){return a.instance==d});a.debug("removeLink - before",c)},d.failure)}},combo:{findAll:function(b,c,e){a.debug("loading for select ",b,c);e.findAll(function(a){_.forEach(a,function(a){c.push({id:a.id,name:a.name})})},d.failure)}}}}}]).factory("genericPickerService",["$log",
"$mdDialog","toastService",function(a,b,c){return{pickers:{confirm:function(a,c,g,f){a=b.confirm().title(a).textContent(c).ariaLabel("Confirm").ok(g).cancel(f);return b.show(a)},nodes:function(a,c,g,f){b.show({controller:f,templateUrl:"js/partials/dialog/nodesDialog.tmpl.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(a){c(a)},function(){g()})},graph:function(a,c,g,f,h){b.show({locals:{anchor:c},bindToController:!0,controller:h,templateUrl:"js/partials/dialog/graphDialog.tmpl.html",
targetEvent:a,clickOutsideToClose:!0}).then(function(a){g(a)},function(){f()})}}}}]);"use strict";
angular.module("JarvisApp.services.scope",["JarvisApp.services.generic"]).factory("genericScopeService",["$log","$filter","genericResourceService","genericPickerService","toastService",function(a,b,c,d,e){return{scope:{resources:function(g,f,h,m,q,k){a.debug("inject default resources scope",m);h.create=function(a,b){c.scope.collections.new(m,f(),a,q,b)};h.new=function(a){c.scope.collections.new(m,f(),k,q,a)};h.crud=c.crud(m.split("/"));h.remove=function(c,e){d.pickers.confirm(b("translate")("action.drop",
{name:c.name,id:c.id}),"",b("translate")("yes"),b("translate")("no")).then(function(){a.debug("remove",c);var b=c.id;_.remove(f(),function(a){return a.id==b});h.crud.delete(c.id);e&&e(c)},function(){a.debug("abort")})};h.load=function(b){g([]);q.findAll(function(c){g(c);a.debug(m+"-ctrl",c);b&&b()},e.failure)}},resource:function(e,f,h,m,q,k,l){a.debug("inject default resource scope",f);e.remove=function(k){d.pickers.confirm(b("translate")("action.drop",{name:k.name,id:k.id}),"",b("translate")("yes"),
b("translate")("no")).then(function(){c.scope.entity.remove(function(){e.go(h)},f,k,m)},function(){a.debug("abort")})};e.save=function(a){c.scope.entity.save(f,a,m)};e.duplicate=function(a){c.scope.entity.duplicate(function(){e.go(h)},f,a,m)}},resourceLink:function(e,f,h,m,q,k,l,n,p){a.debug("inject link",k);f.add=function(b){a.debug("link::add",b);c.scope.link.add(n,b,l,k,e())};f.update=function(b){a.debug("link::update",b);c.scope.link.save(n,b,k)};f.drop=function(f){d.pickers.confirm(b("translate")("action.remove.link",
{name:f.name,id:f.id}),"",b("translate")("yes"),b("translate")("no")).then(function(){a.debug("link::drop",f);p&&p.remove?p.remove(f):c.scope.link.remove(n,f,k,e());p&&p.afterRemove&&p.afterRemove(f)},function(){a.debug("abort")})}}}}}]);"use strict";
angular.module("JarvisApp.services.plugin",[]).factory("pluginResourceService",["$log","Restangular","filterService","commandResourceService","genericResourceService",function(a,b,c,d,e){return{plugins:{findAll:function(a,d){var e=[],m=["scripts"],q=_.after(m.length,function(b){a(b)});_.forEach(m,function(a){b.all("plugins").all(a).getList().then(function(a){_.forEach(a,function(a){e.push(c.plain(a))});q(e)},function(a){d(a)})})}},scripts:e.crud(["plugins","scripts"]),commands:e.links(["plugins",
"scripts"],["commands"])}}]);"use strict";angular.module("JarvisApp.services.command",[]).factory("commandResourceService",["genericResourceService",function(a){return{command:a.crud(["commands"])}}]);"use strict";angular.module("JarvisApp.services.view",[]).factory("viewResourceService",["genericResourceService",function(a){return{view:a.crud(["views"]),iots:a.links(["views"],["iots"])}}]);"use strict";
angular.module("JarvisApp.services.configuration",[]).factory("configurationResourceService",["genericResourceService",function(a){return{configuration:a.crud(["configurations"])}}]);"use strict";angular.module("JarvisApp.services.property",[]).factory("propertyResourceService",["genericResourceService",function(a){return{property:a.crud(["properties"])}}]);"use strict";angular.module("JarvisApp.services.snapshot",[]).factory("snapshotResourceService",["genericResourceService",function(a){return{snapshot:a.crud(["snapshots"])}}]);
"use strict";angular.module("JarvisApp.services.cron",[]).factory("cronResourceService",["genericResourceService",function(a){return{cron:a.crud(["crons"])}}]);"use strict";angular.module("JarvisApp.services.iot",[]).factory("iotResourceService",["genericResourceService",function(a){return{iot:a.crud(["iots"]),plugins:a.links(["iots"],["plugins","scripts"]),iots:a.links(["iots"],["iots"]),triggers:a.links(["iots"],["triggers"])}}]);"use strict";
angular.module("JarvisApp.services.connector",[]).factory("connectorResourceService",["genericResourceService",function(a){return{connector:a.crud(["connectors"])}}]);"use strict";angular.module("JarvisApp.services.event",[]).factory("eventResourceService",["genericResourceService",function(a){return{event:a.crud(["events"])}}]);"use strict";
angular.module("JarvisApp.services.trigger",[]).factory("triggerResourceService",["genericResourceService",function(a){return{trigger:a.crud(["triggers"]),crons:a.links(["triggers"],["crons"])}}]);"use strict";angular.module("JarvisApp.services.scenario",[]).factory("scenarioResourceService",["genericResourceService",function(a){return{scenario:a.crud(["scenarios"]),blocks:a.links(["scenarios"],["blocks"]),triggers:a.links(["scenarios"],["triggers"])}}]);"use strict";
angular.module("JarvisApp.services.block",[]).factory("blockResourceService",["$log","Restangular","genericResourceService","iotResourceService","filterService",function(a,b,c,d,e){return{block:c.crud(["blocks"]),plugins:{"if":c.links(["blocks"],["plugins","scripts"],"HREF_IF"),then:c.links(["blocks"],["plugins","scripts"],"HREF_THEN"),"else":c.links(["blocks"],["plugins","scripts"],"HREF_ELSE")},blocks:{then:c.links(["blocks"],["blocks"],"HREF_THEN"),"else":c.links(["blocks"],["blocks"],"HREF_ELSE")}}}]);
"use strict";
angular.module("JarvisApp.config",[]).config(["$mdIconProvider",function(a){angular.injector(["ng"]).get("$log").info("$mdIconProvider",a)}]).config(["$translateProvider",function(a){angular.injector(["ng"]).get("$log").info("$translateProvider",a);a.useStaticFilesLoader({prefix:"js/l10n/",suffix:".json"});a.preferredLanguage("fr_FR");a.useSanitizeValueStrategy(null)}]).config(["RestangularProvider",function(a){angular.injector(["ng"]).get("$log").info("RestangularProvider",a);a.setBaseUrl("/api");a.setDefaultHeaders({"content-type":"application/json"});
a.setFullRequestInterceptor(function(a,c,d,e,g,f,h){return{element:a,params:f,headers:g,httpConfig:h}});a.setResponseExtractor(function(a){angular.isObject(a)&&(a.originalElement=a);return a})}]).controller("JarvisAppCtrl",["$scope","$log","$store","$http","$mdDialog","$mdSidenav","$mdMedia","$location","$state","genericPickerService","toastService","iotResourceService","eventResourceService","configurationResourceService",function(a,b,c,d,e,g,f,h,m,q,k,l,n,p){b.info("JarvisAppCtrl");a.config={};
a.media=f("xs");a.$watch(function(){return f("xs")},function(b){b&&(a.media="xs")});a.$watch(function(){return f("gt-xs")},function(b){b&&(a.media="gt-xs")});a.$watch(function(){return f("sm")},function(b){b&&(a.media="sm")});a.$watch(function(){return f("gt-sm")},function(b){b&&(a.media="gt-sm")});a.$watch(function(){return f("md")},function(b){b&&(a.media="md")});a.$watch(function(){return f("gt-md")},function(b){b&&(a.media="gt-md")});a.$watch(function(){return f("lg")},function(b){b&&(a.media=
"lg")});a.$watch(function(){return f("gt-lg")},function(b){b&&(a.media="gt-lg")});a.$watch(function(){return f("xl")},function(b){b&&(a.media="xl")});a.$watch(function(){return f("print")},function(b){b&&(a.media="print")});hljs.initHighlightingOnLoad();a.defaultValue=function(a,b){return void 0===a?b:a};a.loadSettings=function(){p.configuration.findAll(function(b){if(b=_.find(b,"active"))a.config=b},k.failure)};a.loadSettings();a.saveSettings=function(){p.configuration.put(a.config,function(a){b.info("Updated",
a)},k.failure)};a.closeSettings=function(){e.hide()};a.settings=function(c){var d=f("sm")||f("xs");e.show({scope:a,preserveScope:!0,templateUrl:"js/partials/dialog/settingsDialog.tmpl.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0,fullscreen:d}).then(function(){b.warn("Saving settings")},function(){b.warn("Cancel settings save")})};a.markdown=new showdown.Converter({tables:"true",ghCodeBlocks:"true"});a.helper=function(c){b.debug("State",m.current.name);d.get("js/helps/fr/"+
m.current.name+".markdown").then(function(c){c=a.markdown.makeHtml(c.data);a.help={content:c.replace(/<table>/g,'\x3ctable class\x3d"table table-striped table-bordered table-hover"\x3e')};b.debug("Help",a.help);g("right").toggle()})};a.toggleSidenav=function(a){g(a).toggle()};a.location=function(a,b){g(a).toggle();h.path(b)};a.go=function(a,b){m.go(a,b)};a.emit=function(a,c){b.debug("JarvisAppCtrl::emit",a,c,a.trigger);n.event.post({trigger:a.trigger,timestamp:(new Date).toISOString(),fired:!0,number:c},
function(a){b.debug("JarvisAppCtrl::emit",a);k.info("event "+a.trigger+"#"+a.id+" emitted")},k.failure)};a.execute=function(c){l.iot.task(c.id,"execute",{},function(c){b.debug("JarvisAppCtrl::execute",c);a.renderdata=c},k.failure)};a.graph=function(a,c){return q.pickers.graph(a,c,function(a){b.debug("Go")},function(){b.debug("Abort")},"graphDialogCtrl")};b.info("JarvisAppCtrl configured")}]).controller("graphDialogCtrl",["$scope","$log","$mdDialog",function(a,b,c){b.info("graphDialogCtrl");a.hide=
function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)}}]).controller("pickPluginDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,d,e){b.info("pickPluginDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Connected Objects",selectable:!1,nodes:[]},{name:"Plugin Scripts",selectable:!1,nodes:[]}];a.crudIot=d.crud(["iots"]);a.crudIot.findAll(function(b){_.each(b,
function(b){b.selectable=!1;a.elementsPicker[0].nodes.push(b)})},e.failure);a.crudScript=d.crud(["plugins","scripts"]);a.crudScript.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[1].nodes.push(b)})},e.failure)}]).controller("pickIotDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,d,e){b.info("pickIotDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Connected Objects",
selectable:!1,nodes:[]},{name:"Plugin Scripts",selectable:!1,nodes:[]}];a.crudIot=d.crud(["iots"]);a.crudIot.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},e.failure);a.crudScript=d.crud(["plugins","scripts"]);a.crudScript.findAll(function(b){_.each(b,function(b){b.selectable=!1;a.elementsPicker[1].nodes.push(b)})},e.failure)}]).controller("pickCommandDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,d,e){b.info("pickCommandDialogCtrl");
a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Commands",selectable:!1,nodes:[]}];a.crud=d.crud(["commands"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},e.failure)}]).controller("pickTriggerDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,d,e){b.info("pickTriggerDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};
a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Triggers",selectable:!1,nodes:[]}];a.crud=d.crud(["triggers"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},e.failure)}]).controller("pickCronDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,d,e){b.info("pickCronDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Crontab objects",
selectable:!1,nodes:[]}];a.crud=d.crud(["crons"]);a.crud.findAll(function(b){_.each(b,function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},e.failure)}]).controller("pickBlockDialogCtrl",["$scope","$log","$mdDialog","genericResourceService","toastService",function(a,b,c,d,e){b.info("pickBlockDialogCtrl");a.hide=function(){c.hide()};a.cancel=function(){c.cancel()};a.answer=function(a){c.hide(a)};a.elementsPicker=[{name:"Blocks",selectable:!1,nodes:[]}];a.crudBlock=d.crud(["blocks"]);a.crudBlock.findAll(function(b){_.each(b,
function(b){b.selectable=!0;a.elementsPicker[0].nodes.push(b)})},e.failure)}]);"use strict";
angular.module("JarvisApp.theme",["ngMaterial"]).config(["$mdThemingProvider",function(a){a.definePalette("customPrimary",{50:"#aaeafd",100:"#92e4fc",200:"#79defc",300:"#60d8fb",400:"#47d2fb",500:"#2ECCFA",600:"#15c6f9",700:"#06bbef",800:"#05a7d6",900:"#0594bd",A100:"#c3f0fe",A200:"#dcf7fe",A400:"#f5fdff",A700:"#0480a5"});a.definePalette("customAccent",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#f8fcfe",400:"#e3f4f9",500:"#CEECF5",600:"#b9e4f1",700:"#a4dcec",800:"#8ed3e8",900:"#79cbe4",A100:"#ffffff",
A200:"#ffffff",A400:"#ffffff",A700:"#64c3df"});a.definePalette("customWarn",{50:"#ff8080",100:"#ff6666",200:"#ff4d4d",300:"#ff3333",400:"#ff1a1a",500:"#FF0000",600:"#e60000",700:"#cc0000",800:"#b30000",900:"#990000",A100:"#ff9999",A200:"#ffb3b3",A400:"#ffcccc",A700:"#800000"});a.definePalette("customBackground",{50:"#ffffff",100:"#ffffff",200:"#ffffff",300:"#ffffff",400:"#ffffff",500:"#F2F2F2",600:"#e5e5e5",700:"#d8d8d8",800:"#cccccc",900:"#bfbfbf",A100:"#ffffff",A200:"#ffffff",A400:"#ffffff",A700:"#b2b2b2"});
a.theme("default").primaryPalette("customPrimary").accentPalette("customAccent").warnPalette("customWarn").backgroundPalette("customBackground")}]);"use strict";
angular.module("JarvisApp.websocket",["angular-websocket"]).factory("$store",["$log","$websocket","$window",function(a,b,c){a.info("Websocket: ",c.location);var d=b("ws://"+c.location.hostname+":"+c.location.port+"/stream/"),e={};d.onMessage(function(a){a=JSON.parse(a.data);void 0===e[a.classname]&&(e[a.classname]={});e[a.classname][a.instance]=a.data});return{collection:e,get:function(){d.send(JSON.stringify({action:"get"}))}}}]);"use strict";
angular.module("JarvisApp.routes",["JarvisApp.config"]).config(["$urlRouterProvider",function(a){angular.injector(["ng"]).get("$log").info("$urlRouterProvider",a);a.otherwise("/home")}]).config(["$stateProvider",function(a){angular.injector(["ng"]).get("$log").info("$stateProvider",a);a.state("home",{url:"/home",controller:"homeCtrl",templateUrl:"/ui/js/partials/home/page.html"}).state("helper-iots",{url:"/helper-iots",controller:"helperCtrl",templateUrl:"/ui/js/partials/helper/jarvis-commands.svg"}).state("helper-scenarii",
{url:"/helper-scenarii",controller:"helperCtrl",templateUrl:"/ui/js/partials/helper/jarvis-scenarii.svg"}).state("events",{url:"/events",controller:"eventsCtrl",templateUrl:"/ui/js/partials/events/page.html"}).state("triggers",{url:"/triggers",controller:"triggersCtrl",templateUrl:"/ui/js/partials/triggers/page.html"}).state("triggers-by-id",{url:"/triggers/:id?tab",controller:"triggerCtrl",templateUrl:"/ui/js/partials/triggers/trigger/page.html"}).state("iots",{url:"/iots",controller:"iotsCtrl",
templateUrl:"/ui/js/partials/iots/page.html"}).state("iots-by-id",{url:"/iots/:id?tab",controller:"iotCtrl",templateUrl:"/ui/js/partials/iots/iot/page.html"}).state("plugins",{url:"/plugins",controller:"pluginsCtrl",templateUrl:"/ui/js/partials/plugins/page.html"}).state("plugins-by-id-script",{url:"/plugins/scripts/:id?tab",controller:"pluginScriptCtrl",templateUrl:"/ui/js/partials/plugins/script/page.html"}).state("commands",{url:"/commands",controller:"commandsCtrl",templateUrl:"/ui/js/partials/commands/page.html"}).state("commands-by-id",
{url:"/commands/:id",controller:"commandCtrl",templateUrl:"/ui/js/partials/commands/command/page.html"}).state("views",{url:"/views",controller:"viewsCtrl",templateUrl:"/ui/js/partials/views/page.html"}).state("views-by-id",{url:"/views/:id",controller:"viewCtrl",templateUrl:"/ui/js/partials/views/view/page.html"}).state("configurations",{url:"/configurations",controller:"configurationsCtrl",templateUrl:"/ui/js/partials/configurations/page.html"}).state("configurations-by-id",{url:"/configurations/:id",
controller:"configurationCtrl",templateUrl:"/ui/js/partials/configurations/configuration/page.html"}).state("properties",{url:"/properties",controller:"propertiesCtrl",templateUrl:"/ui/js/partials/properties/page.html"}).state("properties-by-id",{url:"/properties/:id",controller:"propertyCtrl",templateUrl:"/ui/js/partials/properties/property/page.html"}).state("connectors",{url:"/connectors",controller:"connectorsCtrl",templateUrl:"/ui/js/partials/connectors/page.html"}).state("connectors-by-id",
{url:"/connectors/:id",controller:"connectorCtrl",templateUrl:"/ui/js/partials/connectors/connector/page.html"}).state("snapshots",{url:"/snapshots",controller:"snapshotsCtrl",templateUrl:"/ui/js/partials/snapshots/page.html"}).state("snapshots-by-id",{url:"/snapshots/:id",controller:"snapshotCtrl",templateUrl:"/ui/js/partials/snapshots/snapshot/page.html"}).state("crons",{url:"/crons",controller:"cronsCtrl",templateUrl:"/ui/js/partials/crons/page.html"}).state("crons-by-id",{url:"/crons/:id",controller:"cronCtrl",
templateUrl:"/ui/js/partials/crons/cron/page.html"}).state("scenarios",{url:"/scenarios",controller:"scenariosCtrl",templateUrl:"/ui/js/partials/scenarios/page.html"}).state("scenarios-by-id",{url:"/scenarios/:id?tab",controller:"scenarioCtrl",templateUrl:"/ui/js/partials/scenarios/scenario/page.html"}).state("blocks",{url:"/blocks",controller:"blocksCtrl",templateUrl:"/ui/js/partials/blocks/page.html"}).state("blocks-by-id",{url:"/blocks/:id?tab",controller:"blockCtrl",templateUrl:"/ui/js/partials/blocks/block/page.html"})}]);
"use strict";
angular.module("JarvisApp.directives",[]).directive("appVersion",function(a){return function(b,c,d){c.text(a)}}).directive("fileModel",function(a,b){return{restrict:"A",link:function(b,d,e){var g=a(e.fileModel).assign;d.bind("change",function(){b.$apply(function(){g(b,d[0].files[0])})})}}}).directive("fileSelect",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,g){var f=new a.FileReader;f.onload=function(){var a=f.result.substr(f.result.lastIndexOf(",")+1);b.debug("result:",f.result);
b.debug("result base64 value:",a);g.$setViewValue(atob(a));"fileLoaded"in e&&c.$eval(e.fileLoaded)};f.onprogress=function(a){"fileProgress"in e&&c.$eval(e.fileProgress,{$total:a.total,$loaded:a.loaded})};f.onerror=function(){"fileError"in e&&c.$eval(e.fileError,{$error:f.error})};var h=e.fileSelect;d.bind("change",function(a){a=a.target.files[0];""===h||"text"===h?f.readAsText(a,"UTF-8"):"data"===h&&f.readAsDataURL(a)})}}});"use strict";
angular.module("JarvisApp.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/mg,a)}}]);"use strict";
angular.module("JarvisApp.directives.widgets",["JarvisApp.services"]).directive("jarvisPlugins",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/plugins/jarvis-plugins.html",link:function(b,d,e){a.debug("jarvis-plugins")}}}]).directive("jarvisDefaultMenuBar",["$log","$parse",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tools/jarvis-default-menu-bar.html",require:"ngModel",link:function(a,b,e,g){a.closeMenu=e.close;a.element=function(){return g.$viewValue}}}}]).directive("jarvisPickElement",
["$log","$parse","genericPickerService",function(a,b,c){return{restrict:"E",template:'\x3cmd-button aria-label\x3d"menu" class\x3d"md-icon-button" ng-click\x3d"pickItemDialog($event)"\x3e\x3cmd-tooltip\x3e{{pick.tooltips|translate}}\x3c/md-tooltip\x3e\x3cmd-icon md-font-icon\x3d"material-icons md-16"\x3e{{pick.icon}}\x3c/md-icon\x3e\x3c/md-button\x3e',scope:{},link:function(d,e,g,f){d.pick={};d.pick.tooltips=g.tooltips;d.pick.icon=g.icon;d.pick.tooltips=g.tooltips;d.pick.ctrl=g.ctrl;d.pick.callback=
g.callback;d.pickItemDialog=function(e,f){return c.pickers.nodes(e,function(a){b(d.pick.callback)(d.$parent)(a)},function(){a.debug("no picked element")},d.pick.ctrl)}}}}]).directive("jarvisPluginCommon",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/plugins/script/jarvis-plugin-general.html",link:function(b,d,e){a.debug("jarvis-plugin-common")}}}]).directive("jarvisPluginScript",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/plugins/script/jarvis-plugin-script.html",
link:function(b,d,e){a.debug("jarvis-plugin-script")}}}]).directive("typecommand",["$log",function(a){return{require:"ngModel",link:function(a,c,d,e){e.$validators.typecommand=function(a,b){return e.$isEmpty(a)?!1:"data"==a||"action"==a?!0:!1}}}}]).directive("naturecommand",["$log",function(a){return{require:"ngModel",link:function(a,c,d,e){e.$validators.naturecommand=function(a,b){return e.$isEmpty(a)?!1:"text"==a||"json"==a||"xml"==a?!0:!1}}}}]).directive("jarvisPluginRender",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/plugins/script/jarvis-plugin-result.html",link:function(b,d,e){a.debug("jarvis-plugin-output")}}}]).directive("jarvisIots",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/iots/jarvis-iots.html",link:function(b,d,e){a.debug("jarvis-iots")}}}]).directive("jarvisIot",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/iots/iot/jarvis-iot-general.html",link:function(b,
d,e){a.debug("jarvis-iot-general")}}}]).directive("jarvisIotPlugin",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/iots/iot/jarvis-iot-plugin.html",link:function(b,d,e){a.debug("jarvis-iot-plugin")}}}]).directive("jarvisIotRender",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/iots/iot/jarvis-iot-render.html",link:function(b,d,e){a.debug("jarvis-iot-render")}}}]).directive("jarvisEvents",["$log","$stateParams",function(a,
b){return{restrict:"E",templateUrl:"/ui/js/partials/events/jarvis-events.html",link:function(b,d,e){a.debug("jarvis-iots")}}}]).directive("jarvisTriggers",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/triggers/jarvis-triggers.html",link:function(b,d,e){a.debug("jarvis-triggers")}}}]).directive("jarvisTrigger",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/triggers/trigger/jarvis-trigger-general.html",link:function(b,d,
e){a.debug("jarvis-trigger")}}}]).directive("jarvisTriggerCron",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/triggers/trigger/jarvis-trigger-cron.html",link:function(b,d,e){a.debug("jarvis-trigger-cron")}}}]).directive("jarvisCommands",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/commands/jarvis-commands.html",link:function(b,d,e){a.debug("jarvis-commands")}}}]).directive("jarvisCommand",["$log","$stateParams",function(a,
b){return{restrict:"E",templateUrl:"/ui/js/partials/commands/command/jarvis-command-general.html",link:function(b,d,e){a.debug("jarvis-command")}}}]).directive("jarvisCommandInput",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/commands/command/jarvis-command-input.html",link:function(b,d,e){a.debug("jarvis-command-input")}}}]).directive("jarvisCommandScript",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/commands/command/jarvis-command-script.html",
link:function(b,d,e){a.debug("jarvis-command-script")}}}]).directive("jarvisCommandOutput",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/commands/command/jarvis-command-output.html",link:function(b,d,e){a.debug("jarvis-command-output")}}}]).directive("jarvisViews",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/views/jarvis-views.html",link:function(b,d,e){a.debug("jarvis-views")}}}]).directive("jarvisView",["$log","$stateParams",
function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/views/view/jarvis-view-general.html",link:function(b,d,e){a.debug("jarvis-view")}}}]).directive("jarvisConfigurations",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/configurations/jarvis-configurations.html",link:function(b,d,e){a.debug("jarvis-configurations")}}}]).directive("jarvisConfiguration",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/configurations/configuration/jarvis-configuration-general.html",
link:function(b,d,e){a.debug("jarvis-configuration")}}}]).directive("jarvisProperties",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/properties/jarvis-properties.html",link:function(b,d,e){a.debug("jarvis-properties")}}}]).directive("jarvisProperty",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/properties/property/jarvis-property-general.html",link:function(b,d,e){a.debug("jarvis-property")}}}]).directive("jarvisConnectors",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/connectors/jarvis-connectors.html",link:function(b,d,e){a.debug("jarvis-connectors")}}}]).directive("jarvisConnectorGeneral",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/connectors/connector/jarvis-connector-general.html",link:function(b,d,e){a.debug("jarvis-connector-general")}}}]).directive("jarvisSnapshots",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/snapshots/jarvis-snapshots.html",
link:function(b,d,e){a.debug("jarvis-snapshots")}}}]).directive("jarvisSnapshot",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/snapshots/snapshot/jarvis-snapshot-general.html",link:function(b,d,e){a.debug("jarvis-snapshot")}}}]).directive("jarvisCrons",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/crons/jarvis-crons.html",link:function(b,d,e){a.debug("jarvis-crons")}}}]).directive("jarvisCron",["$log","$stateParams",function(a,
b){return{restrict:"E",templateUrl:"/ui/js/partials/crons/cron/jarvis-cron-general.html",link:function(b,d,e){a.debug("jarvis-cron")}}}]).directive("jarvisScenarios",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/scenarios/jarvis-scenarios.html",link:function(b,d,e){a.debug("jarvis-scenarios")}}}]).directive("jarvisScenario",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/scenarios/scenario/jarvis-scenario-general.html",
link:function(b,d,e){a.debug("jarvis-scenario")}}}]).directive("jarvisScenarioBlocks",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/scenarios/scenario/jarvis-scenario-blocks.html",link:function(b,d,e){a.debug("jarvis-scenario-blocks")}}}]).directive("jarvisScenarioBlock",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/scenarios/scenario/jarvis-scenario-block.html",link:function(b,d,e){a.debug("jarvis-scenario-block")}}}]).directive("jarvisScenarioGraph",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/scenarios/scenario/jarvis-scenario-graph.html",link:function(b,d,e){a.debug("jarvis-scenario-graph")}}}]).directive("jarvisScenarioConsole",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/scenarios/scenario/jarvis-scenario-console.html",link:function(b,d,e){a.debug("jarvis-scenario-console")}}}]).directive("jarvisBlocks",["$log","$stateParams",function(a,b){return{restrict:"E",
templateUrl:"/ui/js/partials/blocks/jarvis-blocks.html",link:function(b,d,e){a.debug("jarvis-blocks")}}}]).directive("jarvisBlock",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/blocks/block/jarvis-block-general.html",link:function(b,d,e){a.debug("jarvis-block")}}}]).directive("jarvisBlockThen",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/blocks/block/jarvis-block-then.html",link:function(b,d,e){a.debug("jarvis-block-then")}}}]).directive("jarvisBlockElse",
["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/blocks/block/jarvis-block-else.html",link:function(b,d,e){a.debug("jarvis-block-else")}}}]).directive("jarvisHome",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/home/jarvis-home.html",link:function(b,d,e){a.debug("jarvis-home")}}}]).directive("jarvisCard",["$log","$parse",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-card.html",scope:!1,
link:function(c,d,e){a.debug("jarvis-card element",b(e.element)(c));a.debug("jarvis-card state",b(e.state)(c));c.element=b(e.element)(c);c.state=b(e.state)(c)}}}]).directive("jarvisTile",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile.html",link:function(b,d,e){a.debug("jarvis-tile")}}}]).directive("jarvisTileBoolean",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-boolean.html",
link:function(b,d,e){a.debug("jarvis-tile-boolean")}}}]).directive("jarvisTileInt",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-int.html",link:function(b,d,e){a.debug("jarvis-tile-int")}}}]).directive("jarvisTilePercent",["$log","$stateParams",function(a,b){return{restrict:"E",templateUrl:"/ui/js/partials/widget/tile/jarvis-tile-percent.html",link:function(b,d,e){a.debug("jarvis-tile-percent")}}}]).directive("jarvisInlineTemplate",["$log",
"$stateParams","$parse",function(a,b,c){return{restrict:"E",template:'\x3cdiv ng-include\x3d"getJarvisInlineTemplateUrl()"\x3e\x3c/div\x3e',link:function(b,e,g){a.debug("jarvis-inline-template id",c(g.id)(b));b.getJarvisInlineTemplateUrl=function(){b.data=c(g.data)(b);return"/api/directives/html/iots/"+c(g.id)(b)}}}}]).directive("jarvisGauge",["$log","$store",function(a,b){return{restrict:"AC",controller:["$scope","$element","$attrs",function(c,d,e){a.debug("jarvis-gauge",e.id);c.gauge=(new Gauge(document.getElementById(e.id))).setOptions({fontSize:10,
lines:10,angle:0,lineWidth:.32,pointer:{length:.9,strokeWidth:.035,color:"#000000"},limitMax:"false",colorStart:"#6FADCF",colorStop:"#8FC0DA",strokeColor:"#E0E0E0",generateGradient:!0});c.gauge.maxValue=100;c.gauge.animationSpeed=10;c.gauge.set(0);c.systemIndicator=function(){return void 0==b.collection||void 0==b.collection.SystemIndicator||void 0==b.collection.SystemIndicator["1"]?0:b.collection.SystemIndicator["1"]};c.$watch(c.systemIndicator,function(a,b,d){c.gauge.set(1E3*a.processCpuLoad)})}]}}]);
"use strict";
angular.module("JarvisApp.ctrl.blocks",["JarvisApp.services"]).controller("blocksCtrl",["$scope","$log","genericScopeService","genericPickerService","blockResourceService","toastService",function(a,b,c,d,e,g){c.scope.resources(function(b){a.blocks=b},function(){return a.blocks},a,"blocks",e.block,{name:"block name",icon:"list",parameter:"{}"})}]).controller("blockCtrl",["$scope","$log","$stateParams","genericScopeService","genericResourceService","genericPickerService","blockResourceService","toastService",
function(a,b,c,d,e,g,f,h){d.scope.resource(a,"block","blocks",f.block);a.links={plugins:{"if":{},then:{},"else":{}},blocks:{then:{},"else":{}}};d.scope.resourceLink(function(){return a.plugins.if},a.links.plugins.if,"block","blocks",f.block,f.plugins.if,{order:"1"},c.id);d.scope.resourceLink(function(){return a.plugins.then},a.links.plugins.then,"block","blocks",f.block,f.plugins.then,{order:"1"},c.id);d.scope.resourceLink(function(){return a.plugins.else},a.links.plugins.else,"block","blocks",f.block,
f.plugins.else,{order:"1"},c.id);d.scope.resourceLink(function(){return a.blocks.then},a.links.blocks.then,"block","blocks",f.block,f.blocks.then,{order:"1"},c.id);d.scope.resourceLink(function(){return a.blocks.else},a.links.blocks.else,"block","blocks",f.block,f.blocks.else,{order:"1"},c.id);a.test=function(b){void 0!=b&&void 0!=b.id&&""!=b.id&&f.block.task(b.id,"test",{},function(b){a.testExpression="true"==b},h.failure)};a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&f.block.task(c.id,
"execute",{},function(d){b.debug("[BLOCK/test]",c,d);a.testExpression=d},h.failure)};a.load=function(){a.activeTab=c.tab;e.scope.entity.get(c.id,function(b){a.block=b},f.block);a.plugins={if:{},then:{},else:{}};a.plugins.if=[];e.scope.collections.findAll("plugins.if",c.id,a.plugins.if,f.plugins.if);a.plugins.then=[];e.scope.collections.findAll("plugins.then",c.id,a.plugins.then,f.plugins.then);a.plugins.else=[];e.scope.collections.findAll("plugins.else",c.id,a.plugins.else,f.plugins.else);a.blocks=
{then:{},else:{}};a.blocks.then=[];e.scope.collections.findAll("blocks.then",c.id,a.blocks.then,f.blocks.then);a.blocks.else=[];e.scope.collections.findAll("blocks.else",c.id,a.blocks.else,f.blocks.else);b.debug("block-ctrl",a.scenario)}}]);"use strict";
angular.module("JarvisApp.ctrl.iots",["JarvisApp.services"]).controller("iotsCtrl",["$scope","$log","genericScopeService","iotResourceService",function(a,b,c,d){c.scope.resources(function(b){a.iots=b},function(){return a.iots},a,"iots",d.iot,{name:"object name",icon:"list"})}]).controller("iotCtrl",["$scope","$log","$state","$stateParams","iotResourceService","pluginResourceService","genericScopeService","genericResourceService","toastService",function(a,b,c,d,e,g,f,h,m){a.getLink=function(){return a.plugins};
f.scope.resource(a,"iot","iots",e.iot);a.links={plugins:{},triggers:{},iots:{}};f.scope.resourceLink(function(){return a.plugins},a.links.plugins,"iot","iots",e.iot,e.plugins,{order:"1"},d.id);f.scope.resourceLink(function(){return a.triggers},a.links.triggers,"iot","iots",e.iot,e.triggers,{order:"1"},d.id);f.scope.resourceLink(function(){return a.iots},a.links.iots,"iot","iots",e.iot,e.iots,{order:"1"},d.id);a.render=function(c){e.iot.task(c.id,"render",{},function(c){b.debug("iotCtrl::render",c);
a.renderdata=c;a.output=angular.toJson(c,!0)},m.failure)};a.load=function(){a.activeTab=d.tab;h.scope.entity.get(d.id,function(b){a.iot=b},e.iot);a.plugins=[];h.scope.collections.findAll("plugins",d.id,a.plugins,e.plugins);a.iots=[];h.scope.collections.findAll("iots",d.id,a.iots,e.iots);a.triggers=[];h.scope.collections.findAll("triggers",d.id,a.triggers,e.triggers);b.info("iot-ctrl")}}]);"use strict";
angular.module("JarvisApp.ctrl.events",["JarvisApp.services"]).controller("eventsCtrl",["$scope","$log","genericScopeService","genericResourceService","eventResourceService",function(a,b,c,d,e){c.scope.resources(function(b){a.events=b},function(){return a.events},a,"events",e.event);a.crud=d.crud(["events"])}]);"use strict";
angular.module("JarvisApp.ctrl.triggers",["JarvisApp.services"]).controller("triggersCtrl",["$scope","$log","genericScopeService","triggerResourceService",function(a,b,c,d){c.scope.resources(function(b){a.triggers=b},function(){return a.triggers},a,"triggers",d.trigger,{name:"trigger name",icon:"settings_remote"})}]).controller("triggerCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","triggerResourceService","toastService",function(a,b,c,
d,e,g,f,h){e.scope.resource(a,"trigger","triggers",f.trigger);a.links={crons:{}};e.scope.resourceLink(function(){return a.crons},a.links.crons,"cron","crons",f.trigger,f.crons,{order:"1"},c.id);a.load=function(){d.scope.entity.get(c.id,function(b){a.trigger=b},f.trigger);a.crons=[];d.scope.collections.findAll("crons",c.id,a.crons,f.crons);b.info("trigger-ctrl")}}]);"use strict";
angular.module("JarvisApp.ctrl.plugins",["JarvisApp.services"]).controller("pluginsCtrl",["$scope","$log","genericScopeService","pluginResourceService",function(a,b,c,d){c.scope.resources(function(b){a.plugins=b},function(){return a.plugins},a,"plugins/scripts",d.scripts,{name:"script name",icon:"list",type:"script"})}]).controller("pluginScriptCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","genericPickerService","pluginResourceService","iotResourceService","commandResourceService",
"toastService",function(a,b,c,d,e,g,f,h,m,q){e.scope.resource(a,"script","plugins",f.scripts);a.links={commands:{}};e.scope.resourceLink(function(){return a.commands},a.links.commands,"script","plugins",f.scripts,f.commands,{order:"1",name:"noname",nature:"info",type:"json"},c.id);a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&f.scripts.task(c.id,"execute",a.rawTestData,function(d){b.debug("pluginScriptCtrl::execute",c,d);a.rawoutput=d;a.output=angular.toJson(d,!0)},q.failure)};a.render=
function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&f.scripts.task(c.id,"render",a.rawTestData,function(d){b.debug("pluginScriptCtrl::render",c,d);a.rawoutput=d;a.output=angular.toJson(d,!0)},q.failure)};a.submit=function(){a.rawTestData=angular.fromJson(a.editTestData);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.clear=function(){a.rawoutput={};a.output=angular.toJson({},!0);a.rawTestData={};a.editTestData=angular.toJson(a.rawTestData,!0);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.setOwner=
function(c){b.debug("setOwner",c);a.script.owner=c.id};a.load=function(){a.activeTab=c.tab;a.clear();a.combo={booleans:[{id:!0,value:"True"},{id:!1,value:"False"}]};d.scope.entity.get(c.id,function(b){a.script=b},f.scripts);a.commands=[];d.scope.collections.findAll("commands",c.id,a.commands,f.commands);a.combo.owners=[{id:void 0,name:"iot.empty"}];d.scope.combo.findAll("owner",a.combo.owners,h.iot);b.info("script-ctrl")}}]);"use strict";
angular.module("JarvisApp.ctrl.commands",["JarvisApp.services"]).controller("commandsCtrl",["$scope","$log","genericScopeService","commandResourceService",function(a,b,c,d){c.scope.resources(function(b){a.commands=b},function(){return a.commands},a,"commands",d.command,{name:"command name",icon:"list"})}]).controller("commandCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","commandResourceService","toastService",function(a,b,c,d,e,g,f){e.scope.resource(a,"command",
"commands",g.command);a.execute=function(b){g.command.task(b.id,"execute",a.rawTestData,function(c){f.info("command "+b.name+"#"+b.id+" executed");a.output=angular.toJson(c,!0)},f.failure)};a.test=function(b){g.command.task(b.id,"test",a.rawTestData,function(c){f.info("command "+b.name+"#"+b.id+" tested");a.output=angular.toJson(c,!0)},f.failure)};a.pretty=function(){b.debug("pretty",a.rawinput);a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.submit=function(){a.rawTestData=angular.fromJson(a.editTestData);
a.jsonTestData=angular.toJson(a.rawTestData,!0)};a.clear=function(){a.rawTestData={"default":"todo"};a.editTestData=angular.toJson(a.rawTestData,!0);a.jsonTestData=angular.toJson(a.rawTestData,!0);a.rawoutput={};a.output=angular.toJson({},!0)};a.load=function(){a.combo={visibles:[{id:!0,value:"common.true"},{id:!1,value:"common.false"}],types:[{id:"SHELL",value:"command.shell"},{id:"COMMAND",value:"command.single"},{id:"GROOVY",value:"command.groovy"},{id:"SSH",value:"command.ssh"}]};a.clear();a.commands=
[];d.scope.entity.get(c.id,function(b){a.command=b},g.command);b.info("command-ctrl")}}]);"use strict";
angular.module("JarvisApp.ctrl.views",["JarvisApp.services"]).controller("viewsCtrl",["$scope","$log","genericScopeService","viewResourceService",function(a,b,c,d){b.info("viewsCtrl");c.scope.resources(function(b){a.views=b},function(){return a.views},a,"views",d.view,{name:"view name",icon:"list"})}]).controller("viewCtrl",["$scope","$log","$stateParams","genericResourceService","genericScopeService","viewResourceService","iotResourceService","toastService",function(a,b,c,d,e,g,f,h){e.scope.resource(a,
"view","views",g.view);a.links={iots:{}};e.scope.resourceLink(function(){return a.iots},a.links.iots,"view","views",g.view,g.iots,{order:"1"},c.id);a.load=function(){a.views=[];d.scope.entity.get(c.id,function(b){a.view=b},g.view);a.iots=[];d.scope.collections.findAll("iots",c.id,a.iots,g.iots);b.info("view-ctrl",a.views)}}]);"use strict";
angular.module("JarvisApp.ctrl.connectors",["JarvisApp.services"]).controller("connectorsCtrl",["$scope","$log","genericScopeService","connectorResourceService",function(a,b,c,d){c.scope.resources(function(b){a.connectors=b},function(){return a.connectors},a,"connectors",d.connector,{name:"connector name",icon:"settings_input_antenna",isRenderer:!1,isSensor:!1,canAnswer:!1})}]).controller("connectorCtrl",["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","connectorResourceService",
"toastService",function(a,b,c,d,e,g,f,h){g.scope.resource(a,"connector","connectors",f.connector);a.ping=function(b){f.connector.task(b.id,"ping",b,function(b){a.status=angular.toJson(b,!0)})};a.load=function(){e.scope.entity.get(c.id,function(b){a.connector=b},f.connector);b.info("connector-ctrl",a.connectors)}}]);"use strict";
angular.module("JarvisApp.ctrl.snapshots",["JarvisApp.services"]).controller("snapshotsCtrl",["$scope","$log","genericScopeService","snapshotResourceService",function(a,b,c,d){c.scope.resources(function(b){a.snapshots=b},function(){return a.snapshots},a,"snapshots",d.snapshot,{name:"snapshot name",icon:"list"})}]).controller("snapshotCtrl",["$scope","$log","$stateParams","$filter","$http","genericResourceService","genericScopeService","snapshotResourceService","iotResourceService","toastService",
function(a,b,c,d,e,g,f,h,m,q){f.scope.resource(a,"snapshot","snapshots",h.snapshot);a.restore=function(a){void 0!=a&&void 0!=a.id&&""!=a.id&&h.snapshot.task(a.id,"restore",{},function(c){b.debug("snapshotCtrl::restore",a,c)},q.failure)};a.download=function(a){void 0!=a&&void 0!=a.id&&""!=a.id&&h.snapshot.task(a.id,"download",{},function(c){var e="export-"+d("date")(new Date,"yyyyMMdd-HHmmss")+".json",f=document.createElement("a");document.body.appendChild(f);f.style="display: none";b.debug("snapshot",
a,c);c=new Blob([angular.toJson(c,!0)],{type:"application/text"});c=window.URL.createObjectURL(c);f.href=c;f.download=e;f.click()},q.failure)};a.upload=function(a){$("#"+a).trigger("click")};a.loaded=function(a,c){a.json=c.data;b.debug("loaded",a,c)};a.load=function(){a.snapshots=[];g.scope.entity.get(c.id,function(b){a.snapshot=b},h.snapshot);b.info("snapshot-ctrl",a.snapshots)}}]);"use strict";
angular.module("JarvisApp.ctrl.crons",["JarvisApp.services"]).controller("cronsCtrl",["$scope","$log","genericScopeService","cronResourceService",function(a,b,c,d){c.scope.resources(function(b){a.crons=b},function(){return a.crons},a,"crons",d.cron,{name:"cron name",icon:"list",cron:"* * * * *"})}]).controller("cronCtrl",["$scope","$log","$stateParams","$filter","$http","genericResourceService","genericScopeService","cronResourceService","iotResourceService","toastService",function(a,b,c,d,e,g,f,
h,m,q){f.scope.resource(a,"cron","crons",h.cron);a.toggle=function(a){b.info(a);h.cron.task(a.id,"toggle",{},function(a){q.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},q.failure)};a.test=function(a){b.info(a);h.cron.task(a.id,"test",{},function(a){q.info("crontab "+crontab.name+"#"+crontab.id+" toggled to "+crontab.status)},q.failure)};a.load=function(){a.crons=[];g.scope.entity.get(c.id,function(b){a.cron=b},h.cron);b.info("cron-ctrl",a.crons)}}]);"use strict";
angular.module("JarvisApp.ctrl.home",["JarvisApp.services"]).controller("homeCtrl",["$scope","$store","$log","viewResourceService","iotResourceService","toastService",function(a,b,c,d,e,g){a.onSwipeLeft=function(){a.tabIndex>=a.views.length-1?a.tabIndex=a.views.length-1:a.tabIndex++};a.onSwipeRight=function(){0>=a.tabIndex?a.tabIndex=0:a.tabIndex--};a.selectTab=function(b,c){a.tabIndex=c};a.activeTab=function(b,c){return a.tabIndex==c};a.load=function(){a.store=b;a.views=[];a.tabIndex=-1;d.view.findAll(function(b){var h=
[];_.forEach(b,function(a){a.ishome&&(a.urlBackground="url('"+a.url+"')",h.push(a))});g.info(h.length+" view(s)");_.forEach(h,function(a){c.info("loading view",a);d.iots.findAll(a.id,function(b){a.iots=b;var d=_.after(a.iots.length,function(){c.debug("Linked iots to view",a.iots)});_.forEach(a.iots,function(a){e.iot.task(a.id,"render",{},function(b){a.render=b;d(a)},g.failure)})},g.failure)});a.views=h;0<a.views.length&&(a.tabIndex=0)},g.failure);c.info("views-ctrl")}}]).controller("helperCtrl",["$scope",
"$store","$log","viewResourceService","iotResourceService","toastService",function(a,b,c,d,e,g){}]);"use strict";
angular.module("JarvisApp.ctrl.configurations",["JarvisApp.services"]).controller("configurationsCtrl",["$scope","$log","genericScopeService","configurationResourceService",function(a,b,c,d){c.scope.resources(function(b){a.configurations=b},function(){return a.configurations},a,"configurations",d.configuration,{name:"default",opacity:"1",backgroundUrl:"http://artroyalephotography.com/wp-content/uploads/2011/08/minimal-gray-to-white-gradient-wallpapers_33797_1920x1200-1024x640.jpg"})}]).controller("configurationCtrl",["$scope",
"$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","configurationResourceService","toastService",function(a,b,c,d,e,g,f,h){g.scope.resource(a,"configuration","configurations",f.configuration);a.load=function(){e.scope.entity.get(c.id,function(b){a.config=b},f.configuration);b.info("configuration-ctrl",a.configurations)}}]);"use strict";
angular.module("JarvisApp.ctrl.properties",["JarvisApp.services"]).controller("propertiesCtrl",["$scope","$log","genericScopeService","propertyResourceService",function(a,b,c,d){c.scope.resources(function(b){a.properties=b},function(){return a.properties},a,"properties",d.property,{key:"key",value:"value"})}]).controller("propertyCtrl",["$scope","$log","$stateParams","$mdDialog","genericResourceService","genericScopeService","propertyResourceService","toastService",function(a,b,c,d,e,g,f,h){g.scope.resource(a,
"property","properties",f.property);a.load=function(){e.scope.entity.get(c.id,function(b){a.property=b},f.property);b.info("property-ctrl",a.properties)}}]);"use strict";
angular.module("JarvisApp.ctrl.scenarios",["JarvisApp.services"]).controller("scenariosCtrl",["$scope","$log","genericScopeService","scenarioResourceService","toastService",function(a,b,c,d,e){c.scope.resources(function(b){a.scenarios=b},function(){return a.scenarios},a,"scenarios",d.scenario,{name:"scenario name",icon:"list"})}]).controller("scenarioCtrl",["$scope","$log","$stateParams","$mdDialog","genericScopeService","genericResourceService","genericPickerService","scenarioResourceService","blockResourceService",
"pluginResourceService","toastService",function(a,b,c,d,e,g,f,h,m,q,k){e.scope.resource(a,"scenario","scenarios",h.scenario);a.links={blocks:{},triggers:{}};e.scope.resourceLink(function(){return a.blocks},a.links.blocks,"scenario","scenarios",h.scenario,h.blocks,{order:"1"},c.id);e.scope.resourceLink(function(){return a.triggers},a.links.triggers,"scenario","scenarios",h.scenario,h.triggers,{order:"1"},c.id);a.build=function(a){var c=[];_.each(a,function(a){b.debug("graph",a.stage);var d="";_.each(a.nodes,
function(a){a.start&&(d+="#"+a.id+"\x3d\x3estart: "+a.name+":\x3e"+a.longId+"\n");a.end&&(d+="#"+a.id+"\x3d\x3eend: "+a.name+":\x3e"+a.longId+"\n");a.activity&&(d+="#"+a.id+"\x3d\x3eoperation: "+a.name+":\x3e"+a.longId+"\n");a.gateway&&(d+="#"+a.id+"\x3d\x3econdition: "+a.name+":\x3e"+a.longId+"\n");a.call&&(d+="#"+a.id+"\x3d\x3esubroutine: "+a.name+":\x3e"+a.longId+"\n")});_.each(a.edges,function(b){d=a.nodes[b.sourceId].gateway?b.bool?d+("#"+b.sourceId+"(yes, right)-\x3e#"+b.targetId+"\n"):d+("#"+
b.sourceId+"(no)-\x3e#"+b.targetId+"\n"):d+("#"+b.sourceId+"-\x3e#"+b.targetId+"\n")});c.push({stage:a.stage,code:d})});return c};a.render=function(a){b.debug(a);$("#canvas").html("");_.each(a,function(a){$("#canvas").append("\x3ch4\x3e"+a.stage+"\x3c/h4\x3e");$("#canvas").append('\x3cdiv id\x3d"canvas-'+a.stage+'"\x3e\x3c/div\x3e')});_.each(a,function(a){b.info("Render",a.stage);flowchart.parse(a.code).drawSVG("canvas-"+a.stage,{"line-width":3,"line-length":50,"text-margin":10,"font-size":12,font:"normal",
"font-family":"Helvetica","font-weight":"normal","font-color":"black","line-color":"black","element-color":"black",fill:"white","yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,symbols:{start:{"font-color":"green","element-color":"green",fill:"yellow"},end:{"font-color":"red","element-color":"red",fill:"yellow"}},flowstate:{past:{fill:"#CCCCCC","font-size":12},current:{fill:"yellow","font-color":"red","font-weight":"bold"},future:{fill:"#FFFF99"},request:{fill:"blue"},invalid:{fill:"#444444"},
approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}})})};a.chart=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&h.scenario.task(c.id,"render",{},function(d){b.debug("[SCENARIO/render]",c,d);a.codes=a.build(d);a.render(a.codes)},k.failure)};a.execute=function(c){void 0!=c&&void 0!=c.id&&""!=c.id&&h.scenario.task(c.id,"execute",{},function(d){b.debug("[SCENARIO/execute]",c,d);a.console=d},k.failure)};
a.load=function(){a.activeTab=c.tab;a.plugin={};g.scope.entity.get(c.id,function(b){a.scenario=b;a.chart(b)},h.scenario);a.blocks=[];g.scope.collections.findAll("blocks",c.id,a.blocks,h.blocks,function(a){_.forEach(a,function(a){a.plugins={};a.plugins.if=[];a.plugins.then=[];a.plugins.else=[];m.plugins.if.findAll(a.id,function(b){a.plugins.if=b});m.plugins.then.findAll(a.id,function(b){a.plugins.then=b});m.plugins.else.findAll(a.id,function(b){a.plugins.else=b});a.blocks={};a.blocks.then=[];a.blocks.else=
[];m.blocks.then.findAll(a.id,function(b){a.blocks.then=b});m.blocks.else.findAll(a.id,function(b){a.blocks.else=b});b.debug("blocks.plugins",a.plugins);b.debug("blocks.blocks",a.blocks)})});a.triggers=[];g.scope.collections.findAll("triggers",c.id,a.triggers,h.triggers);b.debug("scenario-ctrl",a.scenario)}}]);